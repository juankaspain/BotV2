# ═════════════════════════════════════════════════════════════════════
# BotV2 - Environment Variables Template
# Copy this file to .env and fill with your actual values
# ═════════════════════════════════════════════════════════════════════

# USAGE:
# 1. Copy this file: cp .env.example .env
# 2. Fill in your actual values (never commit .env to git)
# 3. Ensure all REQUIRED variables are set before running

# ═════════════════════════════════════════════════════════════════════
# DATABASE CONFIGURATION
# ═════════════════════════════════════════════════════════════════════

# PostgreSQL Configuration (REQUIRED)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DATABASE=botv2
POSTGRES_USER=botv2_user
POSTGRES_PASSWORD=your_secure_password_here_min_8_chars

# Redis Configuration (REQUIRED for rate limiting and caching)
# Redis is now REQUIRED for:
# - Rate limiting (Flask-Limiter backend)
# - Session management
# - Caching (optional but recommended)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ═════════════════════════════════════════════════════════════════════
# EXCHANGE API KEYS
# ═════════════════════════════════════════════════════════════════════

# Polymarket API (REQUIRED for production)
# Get your API key from: https://polymarket.com/
POLYMARKET_API_KEY=your_polymarket_api_key_here
POLYMARKET_API_SECRET=your_polymarket_api_secret_here
POLYMARKET_BASE_URL=https://clob.polymarket.com

# Binance API (OPTIONAL - for crypto trading)
BINANCE_API_KEY=
BINANCE_API_SECRET=
BINANCE_TESTNET=false

# Coinbase Pro API (OPTIONAL)
COINBASE_API_KEY=
COINBASE_API_SECRET=
COINBASE_PASSPHRASE=

# Kraken API (OPTIONAL)
KRAKEN_API_KEY=
KRAKEN_API_SECRET=

# Finst API (PREPARATORY - API not yet available as of January 2026)
FINST_API_KEY=
FINST_API_SECRET=
FINST_TESTNET=false

# ═════════════════════════════════════════════════════════════════════
# NOTIFICATIONS
# ═════════════════════════════════════════════════════════════════════

# Telegram Bot (OPTIONAL - for alerts)
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# Slack Webhooks (OPTIONAL)
SLACK_WEBHOOK_URL=
SLACK_CHANNEL=#botv2-alerts

# Email Notifications (OPTIONAL - via SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@botv2.local
SMTP_TO=alerts@yourdomain.com

# Discord Webhook (OPTIONAL)
DISCORD_WEBHOOK_URL=

# ═════════════════════════════════════════════════════════════════════
# SECURITY & AUTHENTICATION
# ═════════════════════════════════════════════════════════════════════

# Flask Environment (REQUIRED)
# Values: development | production
# - development: HTTPS disabled, allows localhost HTTP, weaker security for testing
# - production: HTTPS enforced, strict security headers, rate limiting active
# IMPORTANT: ALWAYS use 'production' for remote deployments
FLASK_ENV=development
# Secret Key for JWT/Sessions (REQUIRED)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# Or: openssl rand -hex 32
# IMPORTANT: Use different keys for dev/staging/production
# NEVER commit this key to git
SECRET_KEY=generate_random_32_char_secret_key_here

# Dashboard Authentication (REQUIRED for production)
# HTTP Basic Authentication credentials
# 
# Password Requirements:
# - Development: min 8 characters
# - Production: min 16 characters, mixed case, numbers, symbols
# - Never use common passwords (admin, password123, etc.)
# - Rotate every 90 days
#
# Generate strong password:
#   openssl rand -base64 16
#   python -c "import secrets; print(secrets.token_urlsafe(16))"
#
DASHBOARD_USERNAME=admin
DASHBOARD_PASSWORD=admin1234
# API Authentication (REQUIRED if exposing API)
API_KEY=your_internal_api_key_here
API_SECRET=your_internal_api_secret_here

# Encryption Key (OPTIONAL - for encrypting sensitive data at rest)
ENCRYPTION_KEY=

# ═════════════════════════════════════════════════════════════════════
# SECURITY FEATURES - PHASE 1 (25-01-2026)
# ═════════════════════════════════════════════════════════════════════

# CSRF Protection (Flask-WTF)
# - Automatic CSRF token generation
# - Token validation for POST/PUT/DELETE requests
# - Double-submit cookie pattern
# - Token rotation on each request
# - Time-based token expiration
#
# Configuration:
CSRF_ENABLED=true
CSRF_TOKEN_LENGTH=32
CSRF_TOKEN_TTL=3600

# XSS Protection (bleach + DOMPurify)
# - HTML sanitization on backend
# - JavaScript escaping
# - URL validation
# - Safe output encoding
# - Frontend sanitization with DOMPurify
#
# Configuration:
XSS_PROTECTION_ENABLED=true
XSS_STRIP_HTML=false

# Session Management
# - Automatic session timeout
# - Session rotation on privilege changes
# - Activity tracking
# - Secure cookie settings
# - IP address validation
#
# Configuration:
SESSION_TIMEOUT_MINUTES=30
SESSION_MAX_LIFETIME_HOURS=12
SESSION_ACTIVITY_TIMEOUT_MINUTES=15
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax

# Rate Limiting Configuration
# Powered by: Flask-Limiter with Redis backend
# 
# Default Limits (per IP):
# - Global: 10 requests/minute
# - API endpoints: 30 requests/minute
# - Login: 5 attempts/minute
# - Export/Reports: 5 requests/minute
# - Health check: Unlimited (for Docker)
# - WebSocket: Unlimited (real-time updates)
#
# Rate limiting REQUIRES Redis to be running
# If Redis is unavailable, rate limiting is disabled (fails open)
#
RATE_LIMIT_ENABLED=true
RATE_LIMIT_STORAGE=redis://localhost:6379
RATE_LIMIT_DEFAULT=10 per minute
RATE_LIMIT_API=30 per minute
RATE_LIMIT_LOGIN=5 per minute

# Content Security Policy (CSP)
# - Automatic CSP headers
# - Prevents XSS, clickjacking, code injection
# - Whitelist-based approach
# - Configurable per environment
#
# The CSP is automatically configured in src/security/security_middleware.py
# No additional variables needed unless customizing

# HTTPS Enforcement
# Powered by: Flask-Talisman
#
# Production (FLASK_ENV=production):
#   - Automatic HTTP → HTTPS redirect
#   - Strict-Transport-Security (HSTS) header (1 year)
#   - Content-Security-Policy (CSP) headers
#   - X-Frame-Options: DENY (clickjacking protection)
#   - X-Content-Type-Options: nosniff
#   - X-XSS-Protection: 1; mode=block
#   - Referrer-Policy: strict-origin-when-cross-origin
#
# Development (FLASK_ENV=development):
#   - HTTPS enforcement DISABLED
#   - Allows localhost HTTP testing
#   - Self-signed certificates accepted
#
FORCE_HTTPS=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# Request Validation
# - Maximum content length (16MB default)
# - Content-Type validation
# - Request size limits
# - Suspicious pattern detection
#
MAX_CONTENT_LENGTH=16777216
VALIDATE_CONTENT_TYPE=true

# ═════════════════════════════════════════════════════════════════════
# MONITORING & LOGGING
# ═════════════════════════════════════════════════════════════════════

# Security Audit Logging
# - All authentication events
# - Failed login attempts
# - Session management events
# - CSRF validation failures
# - Rate limit violations
# - Suspicious activity detection
#
SECURITY_AUDIT_LOG=logs/security_audit.log
SECURITY_AUDIT_LEVEL=INFO

# Sentry (OPTIONAL - for error tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Datadog (OPTIONAL)
DATADOG_API_KEY=
DATADOG_APP_KEY=
DATADOG_SITE=datadoghq.com

# Prometheus (OPTIONAL)
PROMETHEUS_PORT=9090
PROMETHEUS_ENABLED=false

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=logs/botv2.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# ═════════════════════════════════════════════════════════════════════
# APPLICATION SETTINGS
# ═════════════════════════════════════════════════════════════════════

# System Configuration
BOTV2_ENV=production
ENVIRONMENT=development

# Trading Mode (paper, live)
TRADING_MODE=paper

# Initial Capital (in EUR)
INITIAL_CAPITAL=3000

# Trading Interval (seconds)
TRADING_INTERVAL=60

# Debug Mode
DEBUG=false

# Flask/Dashboard Settings
FLASK_APP=src.dashboard.web_app
DASHBOARD_HOST=0.0.0.0
DASHBOARD_PORT=8050

# ═════════════════════════════════════════════════════════════════════
# EXTERNAL SERVICES (OPTIONAL)
# ═════════════════════════════════════════════════════════════════════

# OpenAI API (OPTIONAL)
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4

# Twitter API (OPTIONAL)
TWITTER_API_KEY=
TWITTER_API_SECRET=
TWITTER_BEARER_TOKEN=

# CoinGecko API (OPTIONAL)
COINGECKO_API_KEY=

# Alpha Vantage (OPTIONAL)
ALPHA_VANTAGE_API_KEY=

# ═════════════════════════════════════════════════════════════════════
# ADVANCED CONFIGURATION
# ═════════════════════════════════════════════════════════════════════

# Cache Settings
CACHE_ENABLED=true
CACHE_TTL=300

# Backtesting
BACKTEST_START_DATE=2023-01-01
BACKTEST_END_DATE=2025-12-31

# ═════════════════════════════════════════════════════════════════════
# SECURITY REMINDERS
# ═════════════════════════════════════════════════════════════════════

# 1. NEVER commit .env to git (already in .gitignore)
# 2. Use strong passwords:
#    - Production: min 16 characters, mixed case, numbers, symbols
#    - Development: min 8 characters (still avoid weak passwords)
# 3. Rotate secrets regularly (every 90 days recommended)
# 4. Use different credentials for dev/staging/production
# 5. Enable 2FA on all exchange accounts
# 6. Store backups of credentials securely (password manager)
# 7. FLASK_ENV=production REQUIRED for remote deployments
# 8. Redis REQUIRED for rate limiting to work
# 9. Setup SSL certificates for HTTPS (Let's Encrypt recommended)
# 10. Monitor security logs:
#     docker compose logs botv2-dashboard | grep -i "failed\|limit\|csrf"
#
# SECURITY DOCUMENTATION:
# - Full security guide: docs/SECURITY_PHASE1.md
# - Deployment checklist: docs/DEPLOYMENT.md
# - Troubleshooting: docs/SECURITY_PHASE1.md#troubleshooting
#
# PHASE 1 COMPLETE:
# ✓ CSRF Protection
# ✓ XSS Prevention
# ✓ Content Security Policy
# ✓ Session Management
# ✓ Rate Limiting
# ✓ Security Headers
# ✓ Input Validation
# ✓ Audit Logging
#
# ═════════════════════════════════════════════════════════════════════
# END OF FILE
# ═════════════════════════════════════════════════════════════════════
